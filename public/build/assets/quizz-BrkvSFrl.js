import{r as n,j as t,c as C}from"./client-3DVn_WlK.js";function O({userId:y}){const[a,k]=n.useState([]),[i,v]=n.useState(0),[c,x]=n.useState(null),[o,b]=n.useState(!1),[S,w]=n.useState(!0),[h,m]=n.useState(null),[j,f]=n.useState(null),[z,p]=n.useState(null),d=localStorage.getItem("auth_token"),l=a[i]||null;n.useEffect(()=>{if(!d)return;(async()=>{w(!0);try{const r=await(await fetch("/api/quizzes",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`}})).json();k(r),r.length>0&&await g(r[0].id)}catch(s){console.error("Error loading quizzes",s)}finally{w(!1)}})()},[]);const g=async e=>{try{const r=await(await fetch(`/api/quiz/${e}/check-answered`,{headers:{Authorization:`Bearer ${d}`}})).json();b(r.answered),r.answered?(m(r.correct),f(r.correct_option_id),p(r.selected_option_id)):(m(null),f(null),p(null))}catch(s){console.error("Error checking if quiz was answered",s)}},I=async()=>{if(!c)return alert("Please select an option");try{const e=await fetch(`/api/quiz/${l.id}/answer`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},body:JSON.stringify({option_id:c})}),s=await e.json();e.ok?(b(!0),m(s.correct),f(s.correct_option_id),p(c)):alert(s.message||"Failed to submit answer.")}catch(e){console.error("Error submitting answer",e),alert("An error occurred while submitting your answer.")}},N=e=>{const s=i+e;s>=0&&s<a.length&&(v(s),x(null),g(a[s].id))},q=e=>{if(!o)return"form-check mb-2";let s="form-check mb-2";return e===z?s+=h?" text-success fw-bold":" text-danger fw-bold":e===j&&(s+=" text-success fw-bold"),s};return S?t.jsx("div",{className:"d-flex justify-content-center p-4",children:t.jsx("div",{className:"spinner-border",role:"status"})}):l?t.jsxs("div",{className:"card shadow mt-4",children:[t.jsxs("div",{className:"card-header bg-primary text-white d-flex justify-content-between align-items-center",children:[t.jsx("h5",{className:"m-0",children:l.title}),t.jsxs("span",{className:"badge bg-light text-primary",children:["Question ",i+1," of ",a.length]})]}),t.jsxs("div",{className:"card-body",children:[t.jsx("p",{children:l.description}),t.jsx("div",{className:"options-container mb-3",children:l.options.map(e=>t.jsxs("div",{className:q(e.id),children:[t.jsx("input",{className:"form-check-input",type:"radio",name:"quizOption",value:e.id,id:`quiz-option-${e.id}`,onChange:()=>x(e.id),checked:o?e.id===z:e.id===c,disabled:o}),t.jsxs("label",{className:"form-check-label",htmlFor:`quiz-option-${e.id}`,children:[e.option_text,o&&e.id===j&&" ✓"]})]},e.id))}),o?t.jsx("div",{className:`alert ${h?"alert-success":"alert-danger"} mt-3`,children:t.jsx("h6",{className:"mb-0",children:h?"✅ Correct!":"❌ Incorrect."})}):t.jsx("button",{className:"btn btn-success mt-2",onClick:I,disabled:!c,children:"Submit Answer"}),t.jsxs("div",{className:"d-flex justify-content-between mt-4",children:[t.jsx("button",{className:"btn btn-outline-secondary",disabled:i===0,onClick:()=>N(-1),children:"← Previous"}),t.jsx("button",{className:"btn btn-outline-primary",disabled:i===a.length-1,onClick:()=>N(1),children:"Next →"})]})]})]}):t.jsx("div",{className:"alert alert-info",children:"No quizzes available right now."})}const u=document.getElementById("quiz-app");u&&C.createRoot(u).render(t.jsx(O,{userId:u.dataset.user,token:u.dataset.token}));
